= content_for :main_header do
  %h1 Users

= form_tag(search_admins_users_path(:role => params[:role]), :class => "search") do
  %fieldset
    .clearfix
      = label_tag :q, "Search"
      .input
        = text_field_tag :q, params[:q], :class => 'xlarge'
        = submit_tag "Search", :class => 'btn'
  = link_to "Reset", admins_users_path(:role => params[:role]) if action_name == 'search'

- if ['manager', 'instructor', 'student'].include?(params[:role])
  = form_tag(filter_admins_users_path(:role => params[:role]), :class => "search") do
    %fieldset
      .clearfix
      = label_tag :institution_id
      .input
        = select_tag(:institution_id, options_from_collection_for_select(Institution.all, "id", "name", params[:institution_id]), { :include_blank => "Please select...", :class => 'xlarge'})
        = submit_tag "Filter", :class => 'btn'
    &nbsp;&nbsp;
    = link_to "Reset", admins_users_path(:role => params[:role]) if controller.action_name == 'filter'

%br
%table#users.listing
  %thead
    %tr
      %th Name
      %th Institution
  %tbody
    - for user in @users
      %tr
        %td= link_to user.name, admins_user_path(user, :role => params[:role])
        %td= user.institution.try(:name).try(:capitalize)

= search_pagination_for(@users, :params => {:q => params[:q], :institution_id => params[:institution_id] })
